<div class="content" *ngIf="users !== undefined">
    <!-- table -->
    <fz-panel-table class="doc-card-margin mt-4">

        <!-- header -->
        <ng-container desc>
            <i class="mr-2 fas fa-user"></i> Users
            <app-docslink class="ml-3" link="https://swarmio-labs.gitbook.io/platform-documentation/account-settings/users"></app-docslink>
        </ng-container>

        <ng-container search>
            <input type="text" placeholder="Search..." name="search" [(ngModel)]="search" class="form-control">
        </ng-container>

        <!-- table -->
        <fz-table table *ngIf="(users | fzFilter: search).length > 0">
            <tr header>
                <th>Email</th>
                <th>Created On</th>
            </tr>
            <tr *ngFor="let user of users | fzFilter: search;">
                <td>{{ user.email }}</td>
                <td>{{getDate(user.created_at) | date: 'medium' }}</td>
                <td>
                    <a fzTip content="Delete user" href="javascript:void(0);">
                        <fz-icon-color-circle color="danger" icon="fas fa-trash" (click)="userToDelete = user; deletemodal.show()"></fz-icon-color-circle>
                    </a>
                </td>
            </tr>
        </fz-table>
        <div class="pl-3 pt-3" table *ngIf="users.length > 0 && search && (users | fzFilter: search).length == 0">
            No results found for <strong>"{{ search }}"</strong>.
        </div>
        <div class="pl-3 pt-3" table>
            <button class="mr-2 mb-2" fzButton [rounded]="true" color="primary" size="sm" (click)="inviteUserModal.show()">Invite a new user to your account</button>
        </div>
        <!-- footer -->
        <ng-container tRows *ngIf="(users | fzFilter: search).length > 0" [ngPlural]="users.length">
            {{users.length}}
            <ng-template ngPluralCase="=1">User</ng-template>
            <ng-template ngPluralCase="other">Users</ng-template>
        </ng-container>
    </fz-panel-table>
</div>

<fz-modal headerTitle="Invite new user to your account" footerPosition="end" #inviteUserModal size="md" centered="true">
    <ng-container content>
        <form [formGroup]="inviteUserForm" (ngSubmit)="inviteUser();inviteUserModal.hide()">
            <div class="form-group">
                <label for="name">Email Address</label>
                <input formControlName="email" type="email" class="form-control {{email?.invalid && (email?.dirty || email?.touched) && 'is-invalid'}}" id="name" placeholder="someone@somewhere.com">
                <small *ngIf="email?.errors?.required && (email?.dirty || email?.touched)" class="text-danger">
                    Required
                </small>
                <small *ngIf="!email?.errors?.required && email?.errors?.pattern && (email?.dirty || email?.touched)" class="text-danger">
                    Must be a valid email address
                </small>
            </div>
            <div class="mt-5 align-content-right">
                <button [disabled]="!inviteUserForm.valid" class="mr-2" fzButton [rounded]="true" color="primary" type="submit">
                    Invite
                </button>
                <button fzButton [rounded]="true" type="button" color="danger" (click)="inviteUserModal.hide()">Cancel</button>
            </div>
        </form>
    </ng-container>
</fz-modal>

<fz-modal-dialog [confirmClose]="true" #deletemodal size="lg">
    <ng-container icon><i fzColor textColor="warning" class="fas fa-exclamation-circle"></i></ng-container>
    <div text>
        <h5 class="text-center">Are you sure you want to delete the user with email address <strong>{{userToDelete?.email}}</strong>?</h5>
        <p class="text-center">This user will no longer be able to access the Swarm IO platform.</p>
    </div>
    <ng-container buttons>
        <button class="mr-2" fzButton [rounded]="true" size="lg" color="primary" (click)="deleteUser();deletemodal.confirm()">
            Yes
        </button>
        <button fzButton [rounded]="true" size="lg" color="danger" (click)="deletemodal.hide()">No</button>
    </ng-container>
</fz-modal-dialog>
